INFO:root:args settings: Namespace(name='base', seed=5281, cpus=6, trail=1, sgd=False, debug=False, log_interval=10, lr=0.0003, epoch=100, batchsz=32, dropout=0.1, clip=10, data_ratio=100, pedp=False, seq=False, cls=True, md=False, gcas=False, residual=True, paths=3, aggr_type='avg', pred_gamma=10.0, plan_gamma=0, state_gamma=0, term_gamma=0.1, beam=False, gumbel=False, tau_plan_a=0.001, tau_plan_t=0.001, temperature=0.001, checkpoint_dir='./checkpoint/cls_base', log_dir='./log/text/cls_base', tb_dir='./log/tb/cls_base', data_dir='./data/multiwoz', nlg_dir='./nlg/template/multiwoz', beta_upper=1, beta_decay=36, beta_lower=0.25, KL_gamma=0, curriculum=1, h_dim=200, search_curriculum=1)
INFO:root:Load processed data file
INFO:root:====================================================================================================
INFO:root:Source Loaded: Total 56750 samples
INFO:root:MultiWOZ | DataLoader train | Total Batches 1706 | Batch Size 32 | time 11.7
INFO:root:====================================================================================================
INFO:root:====================================================================================================
INFO:root:Source Loaded: Total 7365 samples
INFO:root:MultiWOZ | DataLoader valid | Total Batches 225 | Batch Size 32 | time 1.22
INFO:root:====================================================================================================
INFO:root:====================================================================================================
INFO:root:Source Loaded: Total 7372 samples
INFO:root:MultiWOZ | DataLoader test | Total Batches 226 | Batch Size 32 | time 1.2
INFO:root:====================================================================================================
INFO:root:DiaMultiClass(
  (dropout): Dropout(p=0.1, inplace=False)
  (net): Sequential(
    (0): Linear(in_features=553, out_features=200, bias=True)
    (1): ReLU()
    (2): Linear(in_features=200, out_features=200, bias=True)
    (3): ReLU()
    (4): Linear(in_features=200, out_features=166, bias=True)
  )
  (loss): BCEWithLogitsLoss()
)
INFO:root:Planner initialization is done
INFO:root:start imitation
INFO:root:TRAIN | step 0 | Loss 6.98044 | Loss-plan 0.0 | Loss-pred 0.698044 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.03318 | Pred P 0.01748 | Pred R 0.4021| State F1 0.09975 | State P 0.05295 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 10 | Loss 6.75441 | Loss-plan 0.0 | Loss-pred 0.675441 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.02539 | Pred P 0.01353 | Pred R 0.2518| State F1 0.09564 | State P 0.0507 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 20 | Loss 6.23112 | Loss-plan 0.0 | Loss-pred 0.623112 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.02105 | Pred P 0.01224 | Pred R 0.09359| State F1 0.09894 | State P 0.05255 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 30 | Loss 5.35694 | Loss-plan 0.0 | Loss-pred 0.535694 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.01359 | Pred P 0.009148 | Pred R 0.03315| State F1 0.09556 | State P 0.05067 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 40 | Loss 4.08662 | Loss-plan 0.0 | Loss-pred 0.408662 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.008613 | Pred P 0.008207 | Pred R 0.00987| State F1 0.09314 | State P 0.04938 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 50 | Loss 2.52832 | Loss-plan 0.0 | Loss-pred 0.252832 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.001042 | Pred P 0.001563 | Pred R 0.0007813| State F1 0.0975 | State P 0.05172 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 60 | Loss 1.54407 | Loss-plan 0.0 | Loss-pred 0.154407 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09532 | State P 0.05047 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 70 | Loss 1.15944 | Loss-plan 0.0 | Loss-pred 0.115944 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09561 | State P 0.05066 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 80 | Loss 0.961856 | Loss-plan 0.0 | Loss-pred 0.0961856 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09525 | State P 0.05045 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 90 | Loss 0.939934 | Loss-plan 0.0 | Loss-pred 0.0939934 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09719 | State P 0.05162 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 100 | Loss 0.891146 | Loss-plan 0.0 | Loss-pred 0.0891146 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09175 | State P 0.04854 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 110 | Loss 0.762025 | Loss-plan 0.0 | Loss-pred 0.0762025 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09604 | State P 0.05092 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 120 | Loss 0.778941 | Loss-plan 0.0 | Loss-pred 0.0778941 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09343 | State P 0.04948 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 130 | Loss 0.817882 | Loss-plan 0.0 | Loss-pred 0.0817882 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09463 | State P 0.05018 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 140 | Loss 0.808913 | Loss-plan 0.0 | Loss-pred 0.0808913 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09947 | State P 0.05287 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 150 | Loss 0.779199 | Loss-plan 0.0 | Loss-pred 0.0779199 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09421 | State P 0.04989 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 160 | Loss 0.760226 | Loss-plan 0.0 | Loss-pred 0.0760226 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09508 | State P 0.05041 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 170 | Loss 0.752978 | Loss-plan 0.0 | Loss-pred 0.0752978 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09854 | State P 0.05231 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 180 | Loss 0.71614 | Loss-plan 0.0 | Loss-pred 0.071614 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09824 | State P 0.05209 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 190 | Loss 0.700937 | Loss-plan 0.0 | Loss-pred 0.0700937 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09614 | State P 0.05103 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 200 | Loss 0.728897 | Loss-plan 0.0 | Loss-pred 0.0728897 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.0959 | State P 0.05084 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 210 | Loss 0.753664 | Loss-plan 0.0 | Loss-pred 0.0753664 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09427 | State P 0.04995 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 220 | Loss 0.713302 | Loss-plan 0.0 | Loss-pred 0.0713302 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09659 | State P 0.05125 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 230 | Loss 0.687161 | Loss-plan 0.0 | Loss-pred 0.0687161 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09475 | State P 0.05017 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 240 | Loss 0.670975 | Loss-plan 0.0 | Loss-pred 0.0670975 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09874 | State P 0.0524 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 250 | Loss 0.673479 | Loss-plan 0.0 | Loss-pred 0.0673479 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09768 | State P 0.05177 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 260 | Loss 0.666568 | Loss-plan 0.0 | Loss-pred 0.0666568 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09284 | State P 0.04916 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 270 | Loss 0.679511 | Loss-plan 0.0 | Loss-pred 0.0679511 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09777 | State P 0.0519 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 280 | Loss 0.635211 | Loss-plan 0.0 | Loss-pred 0.0635211 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0 | Pred P 0.0 | Pred R 0.0| State F1 0.09652 | State P 0.05118 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 290 | Loss 0.670637 | Loss-plan 0.0 | Loss-pred 0.0670637 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.002083 | Pred P 0.003125 | Pred R 0.001563| State F1 0.09408 | State P 0.04984 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 300 | Loss 0.630798 | Loss-plan 0.0 | Loss-pred 0.0630798 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.005729 | Pred P 0.009375 | Pred R 0.004167| State F1 0.09618 | State P 0.05098 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 310 | Loss 0.641755 | Loss-plan 0.0 | Loss-pred 0.0641755 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.006979 | Pred P 0.0125 | Pred R 0.004948| State F1 0.09725 | State P 0.0516 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 320 | Loss 0.628596 | Loss-plan 0.0 | Loss-pred 0.0628596 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0151 | Pred P 0.025 | Pred R 0.01094| State F1 0.09637 | State P 0.05114 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 330 | Loss 0.679198 | Loss-plan 0.0 | Loss-pred 0.0679198 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0125 | Pred P 0.02187 | Pred R 0.008854| State F1 0.0988 | State P 0.05245 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 340 | Loss 0.626663 | Loss-plan 0.0 | Loss-pred 0.0626663 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.007292 | Pred P 0.0125 | Pred R 0.005208| State F1 0.09331 | State P 0.04938 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 350 | Loss 0.603537 | Loss-plan 0.0 | Loss-pred 0.0603537 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0151 | Pred P 0.025 | Pred R 0.01094| State F1 0.09809 | State P 0.05208 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 360 | Loss 0.656475 | Loss-plan 0.0 | Loss-pred 0.0656475 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.0224 | Pred P 0.0375 | Pred R 0.01615| State F1 0.08995 | State P 0.04755 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 370 | Loss 0.634381 | Loss-plan 0.0 | Loss-pred 0.0634381 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.01458 | Pred P 0.025 | Pred R 0.01042| State F1 0.09393 | State P 0.04979 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 380 | Loss 0.634312 | Loss-plan 0.0 | Loss-pred 0.0634312 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.02083 | Pred P 0.03438 | Pred R 0.0151| State F1 0.09502 | State P 0.0504 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
INFO:root:TRAIN | step 390 | Loss 0.581285 | Loss-plan 0.0 | Loss-pred 0.0581285 | Loss-state 0.0 | Loss-KL 0.0 | Loss-Term 0.0 | | Plan F1 0.0 | Plan P 0.0 | Plan R 0.0| Pred F1 0.03281 | Pred P 0.05625 | Pred R 0.02344| State F1 0.09437 | State P 0.05002 | State R 1.0| Term F1 1.0 | Term P 1.0 | Term R 1.0
